# Windsurf Rules: mindbeamer.io.landing

## Projekt-Informationen
- **Projekttyp**: Laravel
- **Framework-Version**: Laravel 11
- **PHP-Version**: 8.2

## Coding-Standards
- **Coding-Style**: PSR-12
- **Architektur**: Config-driven Queue-Jobs
- **Dokumentation**: PHPDoc mit @param, @return, @throws
- **Schnittstellen**: Interfaces für Services verwenden
- **Service-Registrierung**: Services automatisch registrieren
- **Klassen-Design**: Große Klassen in Module aufteilen
- **Tests**: Tests generieren
- **Mocks**: Mocks vermeiden
- **Kommentar-Stil**: PHPDoc
- **Typsystem**: Strict Typing

## Fokus auf Verzeichnisse
- app/Services
- app/Jobs
- app/Console
- config/
- routes/web.php
- routes/console.php

## Ausgeschlossene Verzeichnisse
- vendor/
- node_modules/
- storage/
- public/
- .env
- .idea/
- tests/Browser/
- bootstrap/cache/

## Ziele
- Das Verhalten des Programms darf sich bei Refactoring niemals ändern.
- Reduziere Redundanz – nutze Hilfsklassen, Collections und Laravel-Komponenten.
- Nutze Laravel-Standards wie Eloquent, FormRequests, Middleware, Policies.
- Vermeide Logik in Blade-Views und Controllern – verwende Services.
- Implementiere immer sicheres Coding: keine Mass-Assignment-Lücken, kein unsicherer Input.
- Erzeuge Code, der direkt einsatzbereit ist – keine Platzhalter, keine Mocks.
- Funktioniere stabil auf Mac (dev) und VPS (prod) – keine plattformabhängigen Pfade.

## Refactoring
- **Definition**: Refactoring ist das Ändern der internen Struktur des Codes bei absolut identischem Verhalten.
- **Grundsatz**: Bei 'Refactoring' darf sich das äußere Verhalten (Inputs, Outputs, Ablauf) in keiner Weise ändern.
- **Grenzen**: Ändere keine Logik, keine Bedingungen, keine Seiteneffekte – nur Struktur, Lesbarkeit, Wiederverwendbarkeit.
- **Erlaubt**: Neue Methoden, kleinere Services, bessere Namen – aber keine neue Funktionalität.
- **Validierung**: Jede Refaktorierung muss durch Tests oder Codevergleich validiert werden.

## Umgebungsvariablen
- Bearbeite niemals die .env-Datei direkt.
- Frage immer explizit nach, wenn Umgebungsvariablen geändert werden sollen.

## Deployment-Überlegungen
- Der Code muss auf macOS (Entwicklung) und Linux VPS (Produktion) ohne Änderungen lauffähig sein.
- Vermeide systemabhängige Pfade, File-Permissions oder Sonderbefehle (z. B. brew-only Tools).

## Coding-Standards
- Verwende PSR-12-konformen Code mit strict_types und PHP 8.2 Features.
- Vermeide Ein-Buchstaben-Variablen – nutze sprechende Namen.
- Halte dich an Laravel-Konventionen: Controller-, Model-, Request-Benennung etc.

## Vermeidung von Redundanz
- Wiederhole keinen Code – extrahiere ihn in Services, Traits oder Helper.
- Nutze Laravel Collections (map, filter, reduce), statt klassische Schleifen.

## Dateimanagement
- Keine Datei darf über 500 Zeilen wachsen – splitte in sinnvolle Module.
- Controller enthalten nur Routinglogik – alles andere gehört in Services.

## Laravel Best Practices
- Nutze Dependency Injection statt Facades.
- Verwende Middleware für Auth/Role-Checks.
- Nutze FormRequest-Klassen für Validierung.
- Vermeide DB::table() – nutze Eloquent mit Scopes & Beziehungen.

## Code-Generierung
- Kein Beispielcode oder Halbfertiges – alles muss direkt produktiv einsetzbar sein.
- Alle Methoden und Services müssen vollständig implementiert sein.
- Edge Cases, Error Handling, Rückgabewerte und Tests müssen berücksichtigt sein.

## Tests
- Generiere nach Möglichkeit testbaren Code (entkoppelt, deterministisch, ohne globale Zustände).
- Verwende Laravel-Teststruktur: Feature- und Unit-Tests im tests/-Verzeichnis.
- Jede neu erzeugte Serviceklasse sollte eine zugehörige Testklasse erhalten, sofern sinnvoll.

## Git-Deployment
### Beschreibung
Git-Deployment-Konfiguration für Laravel-Projekte auf Plesk-Servern

### Server-Typ
- Plesk

### Regeln
- Verwende SSH-Schlüsselauthentifizierung für passwortloses Deployment.
- Benenne Git-Remotes aussagekräftig (z.B. s22-projektname-web statt 'origin').
- Nutze post-receive-Hooks für automatisches Deployment und Laravel-Optimierungen.
- Bewahre wichtige Dateien (.env, storage-Verzeichnis) bei Deployments.
- Führe nach jedem Deployment die Laravel-Artisan-Befehle für Caching und Optimierung aus.

### SSH-Setup
- **Schlüsselgenerierung**: ssh-keygen -t ed25519 -C "projektname git access"
- **Server-Installation**: echo "[SSH-KEY]" >> ~/.ssh/authorized_keys

### Post-Receive-Hook
#### Features
- Automatisches Deployment ins Webverzeichnis
- Laravel Artisan-Befehle (cache:clear, config:cache, etc.)
- Composer-Dependency-Management
- Beibehaltung der .env und storage-Inhalte
- Korrekte Berechtigungen für Produktionsumgebung

#### Script
- Pfad: /Users/martin/Laravel-Projekte/mindbeamer.io.landing/post-receive-hook.sh
- Installation: Der Hook muss in ~/git/repository.git/hooks/post-receive auf dem Server platziert werden

### Workflow
- **Entwicklung**: Lokale Entwicklung in PHPStorm
- **Deployment**: Commit und Push via Shift+Cmd+K in PHPStorm
- **Produktion**: Automatisches Update auf dem Server durch post-receive-Hook
